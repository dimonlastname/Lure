{"version":3,"sources":["lure.content.js"],"names":["_classCallCheck","instance","Constructor","TypeError","_createClass","defineProperties","target","props","i","length","descriptor","enumerable","configurable","writable","Object","defineProperty","key","protoProps","staticProps","prototype","Lure","console","error","Plugin","Content","Version","LureContent","_ref","MakeContent","Controller","Array","isArray","Data","this","CreateElementFromString","replace","match","group","x","matche","Target","appendChild","construct","Type","Name","AllContents","ContentList","Refresh","bind","Select","s","$this","SelectAll","GetParent","stringName","arguments","undefined","content","Parent","GetContent","parent","found","searcher","isContent","GetIndex","HTMLElement","slice","call","parentElement","children","indexOf","AddEventListener","eventName","selector","func","AddEventListenerGlobal","AddTutor","buttonTutorStarter","MonsieurTutor","_SortBy","f","data","log","sort","a","b","_Sorting","Sorted","kf","hasOwnProperty","classList","remove","add","_FilterBy","p","performance","now","filters","_d","_Filter","_DataDefault","_loop","Filter","filter","toString","toLowerCase","_sorter","_Data","PageSize","_PageSize","_PageCursor","_Rebuilder","mr","PerformanceNow","Props","k","GetSet","getOwnPropertyDescriptor","Methods","Show","e","isActive","Control","Active","style","window","getComputedStyle","duration","eval","transitionDuration","durationAni","animationDuration","isVisible","forEach","item","Hide","Dialog","_DialogCount","DialogWrapper","document","body","onclick","zIndexWrapper","parseInt","zIndex","zIndexContent","Number","isNaN","DialogBlur","background","DialogAnimation","BeforeShow","Shower","display","clearTimeout","__private","ToggleTimer","setTimeout","Disactive","Hider","Toggle","OnClick","SubContent","cname","TitleContent","Title","Visible","isController","isHasEditable","_EditablesEventListenerRun","Sorting","_loop2","addEventListener","info","Filtering","_loop3","innerHTML","querySelector","value","push","from","contains","AfterBuild","_ref$Target","_ref$Content","_ref$CSS","CSS","_ref$Name","_ref$Global","Global","_ref$Title","_ref$Type","_ref$Visible","_ref$SubContent","_ref$Dialog","_ref$DialogWrapper","_ref$DialogBlur","_ref$DialogAnimation","_ref$Show","_ref$Hide","_ref$Shower","_ref$Hider","_ref$BeforeShow","_ref$Refresh","_ref$Sorting","_ref$Filtering","_ref$OnClick","_ref$Controller","_ref$Control","_ref$Props","_ref$Methods","_ref$GetSet","_ref$AfterBuild","_ref$Disabled","Disabled","_ref$Parent","GetFileText","then","node","createElement","RefreshOne","removeData","Remove","itemData","extraclass","isPrepend","addData","Add","index","Edit","get","set","t","Items","LureControl","control","owner","_this","controls","_loop4","Math","random","substr","_Content","isGlobal","OnChange","currentTarget","onchange","type","Templator","_ref2","_ref2$Target","_ref2$Data","_ref2$ListElement","ListElement","_ref2$EmptyMessage","EmptyMessage","_ref2$EmptyHide","EmptyHide","_ref2$PageSize","_ref2$DataCount","DataCount","_ref2$PageGet","PageGet","_ref2$ShowAllButton","ShowAllButton","_ref2$LineSave","LineSave","line","property","newValue","callback","_ref2$LineAdd","LineAdd","dataObject","_ref2$EditModeSwitch","EditModeSwitch","_ref2$NoAnimation","DataSaveAll","NoAnimation","_ref2$NoBuild","NoBuild","_ref2$BeforeBuild","BeforeBuild","_ref2$AfterBuild","_ref2$AfterAdd","AfterAdd","_ref2$Parent","_DataCount","_PageGet","isShowAllButton","isNoAnimaton","isEmptyHide","Dictionary","_Dictionary","Refresher","j","fields","isAttribute","NewValue","BuildValue","obj","attributes","split","lines","querySelectorAll","NextCount","Limit","paginator","tag","empty","_LineBuilder","CreateElementsFromString","tagName","also","showAll","isTable","colspan","btnNext","BuildWithIt","Build","btnNextAll","FieldAdd","element","elemAttributes","WhatFields","name","Compile","childNodes","PageCursor","newItem","itemOld","parentNode","replaceChild","fragment","createDocumentFragment","elem","dataset","unshift","prepend","splice","SwitchToEditMode","Editable","EditMode","AddEdits","isListElementCssSelector","outerHTML","list_element","list_elementClassed","pos","checked","click","MonsieurController","AllChildren","TemplatorList","TreeBuilder","_ref3","_ref3$Target","_ref3$Data","_ref3$ListElement","_ref3$Drop","Drop","_ref3$SubSelector","SubSelector","_ref3$SubSelectorHand","SubSelectorHandler","_ref3$BeforeBuild","_ref3$AfterBuild","_ref3$Parent","SubTreeClass","Lvl","Branch","html","entag","LineBuilder","Index","BuildElement","indexJ","extra","$lvl","$key","$index","$j","ObjItem","sub","Tutor","TargetButton","TargetContent","MT","ContentBG","_Description","_Step","_ButtonNext","_ButtonStop","ButtonNextText","TutorPosition","temp","ColorTransparent","backgroundColor","ElemCssRestore","Element","position","outline","nElements","ElemCssSet","Run","Confirm","desc","GoStep","Stop","ElementDesc","ElemParent","closest","opacity","posX","offsetLeft","clientWidth","posY","offsetTop","clientHeight","innerWidth","documentElement","scrollTop","innerHeight","offsetHeight","left","top","Load","MonsieurLoading","_ref4","_ref4$Target","cx","cy","_DoArc","radius","maxAngle","d","angle","rad","PI","cos","y","sin","svg","Timeout","TimeoutHide","Tooltip","MonsieurTooltip","_ref5","_ref5$Target","_ref5$Attribute","Attribute","_ref5$Delay","Delay","_ref5$Time","Time","_ref5$Custom","Cursor","Custom","_ref5$AfterBuild","ToolTip","Timer","Destr","text"],"mappings":"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","file":"lure.content.min.js","sourcesContent":["//sets = {\r\n//  SubContent: [\r\n//      {sets},                             -same object to create subs\r\n// ],\r\n//\r\n// Controller:{                                   - if needs some Template master\r\n//    Type: Templator,                                    - class link [optional] Templator by default\r\n//    Target: {string|HTMLElement}                        -[optional] if Controller.Target is undefined, Controller.Target = sets.Target\r\n//    Data: {array|object},                               - data array [optional] Data === [] by default\r\n//    ListElement: {string|HTMLElement},                  - repeated element\r\n//    EmptyMessage: \"no items\",                           - render if Data.length === 0;\r\n\r\n//  Control: {\r\n//    Target: {string, jQuery, HTMLElement},\r\n//    Global: {bool}                               - set global event listener. Set true if control renders after init or it renders dynamicly\r\n//    OnClick: {function}                          - here this === current Lure.Content\r\n//    OnChange: {function}                         - here this === current Lure.Content\r\n// },}\r\n\r\n\r\nif (typeof Lure === 'undefined'){\r\n    console.error('[Lure] Lure core is not defined');\r\n}\r\n\r\nLure.Plugin.Content = {\r\n    Version: '0.9.1',\r\n    Content: class LureContent {\r\n        constructor({                       //--Lure.Content Settings--\r\n                        Target     = null,              //{string, HTMLElement} - where to render       [by default this.Parent.Content];\r\n                        Content    = null,              //{string}  - html content string, if           [by default this.Target.innerHTML]\r\n                        CSS        = '',                //{string}  - css classes string\r\n                        Name       = null,              //{string}  - Lure.Content's name. Need for search content by .GetContent(contentName)\r\n                        Global     = false,             //{bool}    - actual for SubContent. Set true, if SubContent is outside of Parent\r\n                        Title      = \"\",                //{string}  -  header element, contains name/caption/title of content\r\n                        Type       = \"Untyped\",         //{string}  - if has - this.Content will be invisible by default, if need be visible set next property:\r\n                        Visible    = undefined,         //{bool}    - make visible by default (if has no Type - visible by default)\r\n                        SubContent = [],                //{Array} of Lure.Content Settings\r\n                        Dialog     = false,             //{bool} - make dialog absolute window with dialog wrapper\r\n                        DialogWrapper = true,           //{bool} - show dialog  wrapper bg\r\n                        DialogBlur = null,              //{string, jQuery, HTMLElement} target background for blur when dialog\r\n                        DialogAnimation = null,         //{string} - css animation name\r\n                        Show       = null,              //{function} - show action\r\n                        Hide       = null,              //{function} - hide action\r\n                        Shower     = function(){this.Content.style.display = '';},       //custom show handler [calls before .Show]\r\n                        Hider      = function(){this.Content.style.display = 'none';},   //custom hide handler [calls before .Hide]\r\n                        BeforeShow = function(){},      //{function} - calls before .Shower and .Show\r\n                        Refresh    = function(data, i){\r\n                            if (this.Controller)\r\n                                this.Controller.Refresh(data, i)\r\n                        },                              //{function} - refresh content, may be call on page resize for example\r\n                        Sorting    = false,             //{object}   - sort controls by field like 'field' -> '{css|HTMLElement}'  ex.: { count: '.head .count'}\r\n                        Filtering  = false,             //{object}   - like sorting, but fast filter textbox would be\r\n                        OnClick    = null,              //{function} - this.Content.onclick event\r\n                        Controller = null,              //{object} contoller settings(Templator or TreeBuilder)\r\n                        Control    = null,              //{object} (help upper)\r\n\r\n\r\n                        Props      = function(){},      //{function}  - recomented for extra fields  for Lure.Content (this.Extrafield =...)\r\n                        Methods    = function(){},      //{function}  - recomented for extra methods for Lure.Content (this.ExtraMethod = function(){...} )\r\n                        GetSet     = {},                //{function}  - recomenter for extra getters and setters for Lure.Content\r\n                        AfterBuild = function(){},      //{function} - calls after Lure.Content init\r\n                        Disabled   = false,             //debugging,\r\n                        Parent     = null               //link to parent Lure.Content of SubContent\r\n                    })\r\n\r\n        {\r\n            if (Disabled)\r\n                return;\r\n            let $this = this;\r\n            this.isContent = true;\r\n            this.isActive = true;\r\n            if (Name  === 'Tooltipchek')\r\n                ;//debugger;\r\n\r\n            this.Parent = Parent;\r\n            if (Parent !== null){\r\n                this.Target = Global? Lure.Select(Target) : Lure.Select(Target, this.Parent.Content);\r\n                if (this.Target === null)\r\n                    this.Target = this.Parent.Content;\r\n            }\r\n            else if (Target !== null){\r\n                this.Target = Lure.Select(Target);\r\n            }\r\n            // debugger;\r\n            ////\r\n            if (Content === null){\r\n                this.Content = this.Target;\r\n                construct.call($this);\r\n            }else{\r\n                if (Content.match(/<[^>]+>/) === null) {//if not dom string\r\n                    console.log('get load');\r\n                    Lure.GetFileText(Content).then(x => {\r\n                        // debugger;\r\n                        //     console.log('x', x);\r\n                        MakeContent.call($this, x);\r\n                        construct.call($this);\r\n                    });\r\n                }else {\r\n                    MakeContent.call($this, Content);\r\n                    construct.call($this);\r\n                }\r\n\r\n\r\n            }\r\n            function MakeContent(Content){\r\n                if (Controller === null || Array.isArray(Controller.Data))\r\n                {\r\n                    this.Content = Lure.CreateElementFromString(Content);\r\n                }\r\n                else if (Controller !== null && !Array.isArray(Controller.Data))\r\n                {\r\n                    /*Content = Content.replace(/<[^>]+>([^<]*{{([^#}]+)}}[^<]*)<[^>]+>/g, function (match, group) {\r\n                     let newGroup = group.replace(/{{[^#}]+}}/g, function (match) {\r\n                     return match.replace(match, `<span>${match}</span>`);\r\n                     });\r\n                     return  match.replace(group, newGroup);\r\n                     });*/\r\n                    Content = Content.replace(/>[^>]*({{[^#}]+}})[^>]*</g, function (match, group) {\r\n                        /*let newGroup = group.replace(/{{[^#}]+}}/g, function (match) {\r\n                         return match.replace(match, `<span>${match}</span>`);\r\n                         });*/\r\n                        const x = match.replace(/{{[^#}]+}}/g, function (matche) {\r\n                            return `<span>${matche}</span>`\r\n                        });\r\n                        return x;// match.replace(group, `<span>${group}</span>`);\r\n                    });\r\n                    this.Content = Lure.CreateElementFromString(Content);\r\n                }\r\n                //this._Content = Content;\r\n                this.Target.appendChild(this.Content);\r\n            }\r\n\r\n            /////\r\n            if (this.Content === null || this.Target === null)\r\n            {\r\n                this.isContent = false;\r\n                return;\r\n            }\r\n\r\n\r\n\r\n\r\n            //### CONSTRUCTION\r\n            if (CSS !== ''){\r\n                let node = document.createElement('style');\r\n                node.innerHTML = CSS;\r\n                document.body.appendChild(node);\r\n            }\r\n            function construct(){\r\n                this.Type = Type;\r\n                this.Name = Name;\r\n                this.AllContents = Lure.ContentList;\r\n\r\n\r\n                //### METHODS\r\n                /**\r\n                 * @param {object} Data\r\n                 * @param {int} index\r\n                 */\r\n                this.Refresh = Refresh.bind(this);\r\n                /**\r\n                 *\r\n                 * @param {selector|HTMLElement} s\r\n                 * @returns {HTMLElement}\r\n                 * @constructor\r\n                 */\r\n                this.Select = function(s){\r\n                    return Lure.Select(s, $this.Content)\r\n                };\r\n                /**\r\n                 *\r\n                 * @param {selector|HTMLElement} s\r\n                 * @returns {NodeList}\r\n                 * @constructor\r\n                 */\r\n                this.SelectAll = function(s){\r\n                    return Lure.SelectAll(s, $this.Content)\r\n                };\r\n                /**\r\n                 *\r\n                 * @param {string}stringName\r\n                 * @constructor\r\n                 * @returns {Lure.Content}\r\n                 */\r\n                this.GetParent = function(stringName='root'){\r\n                    let content = $this;\r\n                    while (content.Parent !== null && content.Name !== stringName)\r\n                        content = content.Parent;\r\n                    return content;\r\n                };\r\n                /**\r\n                 *\r\n                 * @param {string}stringName\r\n                 * @constructor\r\n                 * @returns {Lure.Content}\r\n                 */\r\n                this.GetContent = function (stringName='root') {\r\n                    let parent = this.GetParent(stringName);\r\n                    if (parent.Name === stringName)\r\n                        return parent;\r\n                    // let root = parent;\r\n                    let found = parent;\r\n                    if (stringName === 'root')\r\n                        return found;\r\n                    let searcher0 = function (content) {\r\n                        if (content.isContent && content.__private.ContentNames)\r\n\r\n                            for( let i = 0; i < content.__private.ContentNames.length; i++){\r\n                                let name = content.__private.ContentNames[i];\r\n                                if (name === stringName)\r\n                                    return content[name];\r\n                                found = searcher(content[name])\r\n                            }\r\n                        return found;\r\n                    };\r\n                    let searcher = function (content) {\r\n                        // debugger;\r\n                        for(let key in content){\r\n                            if (key !== \"Parent\" && !!content[key] && content[key].isContent){\r\n\r\n                                if (content[key].Name === stringName)\r\n                                    return content[key];\r\n                                found = searcher(content[key]);\r\n                            }\r\n\r\n                        }\r\n                        return found;\r\n                    };\r\n                    return searcher(found);\r\n\r\n                };\r\n                /**\r\n                 *\r\n                 * @param {HTMLElement|string} HTMLElement\r\n                 * @returns {number|Number}\r\n                 * @constructor\r\n                 */\r\n                this.GetIndex = function (HTMLElement) {\r\n                    HTMLElement = $this.Select(HTMLElement);\r\n                    return Array.prototype.slice.call( HTMLElement.parentElement.children ).indexOf(HTMLElement);\r\n                };\r\n                /**\r\n                 *\r\n                 * @param {string} eventName\r\n                 * @param {string} selector\r\n                 * @param {function} func\r\n                 * @constructor\r\n                 */\r\n                this.AddEventListener = function (eventName, selector, func) {\r\n                    Lure.AddEventListenerGlobal(eventName,selector,func, $this.Content, $this);\r\n                };\r\n                /**\r\n                 *\r\n                 * @param {string|HTMLElement} buttonTutorStarter\r\n                 * @constructor\r\n                 */\r\n                this.AddTutor = function (buttonTutorStarter) {\r\n                    $this.MonsieurTutor = new MonsieurTutor($this.Select(buttonTutorStarter), $this.Content);\r\n                };\r\n                //private\r\n                this._SortBy = function(f, data, isSorted = false){\r\n                    if (data.length < 2)\r\n                        return;\r\n                    console.log('sort by', f);\r\n                    data.sort(function (a, b) {\r\n                        if      ((a[f] < b[f]) && $this._Sorting[f].Sorted)\r\n                            return 1;\r\n                        else if ((a[f] > b[f]) && $this._Sorting[f].Sorted)\r\n                            return -1;\r\n                        else if ((a[f] < b[f]) && !$this._Sorting[f].Sorted)\r\n                            return -1;\r\n                        else if ((a[f] > b[f]) && !$this._Sorting[f].Sorted)\r\n                            return 1;\r\n                        return 0;\r\n                    });\r\n                    $this._Sorting[f].Sorted = !$this._Sorting[f].Sorted;\r\n                    for (let kf in $this._Sorting){\r\n                        if ($this._Sorting.hasOwnProperty(kf) && kf !== '_sorter'){\r\n                            $this._Sorting[kf].Target.classList.remove('mt-sorting-up');\r\n                            $this._Sorting[kf].Target.classList.remove('mt-sorting-down');\r\n                            if (f !==kf)\r\n                                $this._Sorting[kf].Sorted = false;\r\n                        }\r\n                    }\r\n                    $this._Sorting[f].Target.classList.add($this._Sorting[f].Sorted ? 'mt-sorting-down':'mt-sorting-up');\r\n                    $this.Refresh();\r\n                };\r\n                this._FilterBy = function () {\r\n                    let p = performance.now();\r\n                    let filters = 0;\r\n                    let _d = $this._Filter._DataDefault.slice(0);\r\n                    for (let f in $this._Filter){\r\n                        if ($this._Filter.hasOwnProperty(f) && $this._Filter[f].Filter && $this._Filter[f].Filter !==''){\r\n                            _d = _d.filter(x=>x[f].toString().toLowerCase().indexOf($this._Filter[f].Filter) > -1);\r\n                            filters++;\r\n                        }\r\n                    }\r\n                    console.log(_d);\r\n                    if (filters === 0)\r\n                    {\r\n                        if ($this._Sorting._sorter){\r\n                            $this._Sorting[$this._Sorting._sorter].Sorted = !$this._Sorting[$this._Sorting._sorter].Sorted;\r\n                            $this._SortBy($this._Sorting._sorter, $this.Controller._Data);\r\n                        }\r\n                        $this.Controller.Refresh();\r\n                    }\r\n                    else\r\n                    {\r\n                        if ($this._Sorting._sorter){\r\n                            $this._Sorting[$this._Sorting._sorter].Sorted = !$this._Sorting[$this._Sorting._sorter].Sorted;\r\n                            $this._SortBy($this._Sorting._sorter, _d);\r\n                        }\r\n                        $this.Controller.PageSize = $this._PageSize;\r\n                        $this.Controller._PageCursor = 0;\r\n                        $this.Controller._Rebuilder(_d);\r\n\r\n                    }\r\n\r\n                    mr.PerformanceNow(p, 'FilterBy')\r\n                };\r\n\r\n                //extra properties\r\n                Props.call(this);\r\n                //extra getters/setters\r\n                for(let k in GetSet){\r\n                    Object.defineProperty($this, k, Object.getOwnPropertyDescriptor(GetSet, k));\r\n                }\r\n                //extra methods\r\n                Methods.call(this);\r\n                //--\r\n                this.Show = function(e) {\r\n                    this.isActive = true;\r\n                    if (this.Control)\r\n                        this.Control.Active();\r\n                    let style = window.getComputedStyle($this.Content);\r\n                    let duration = eval(style.transitionDuration.replace('ms', '*1').replace('s', '*1000'));\r\n                    let durationAni = eval(style.animationDuration.replace('ms', '*1').replace('s', '*1000'));\r\n                    if (duration < durationAni)\r\n                        duration = durationAni;\r\n                    duration++;\r\n                    if ($this.Type !== \"Untyped\" && !$this.isVisible)\r\n                    {\r\n                        Lure.ContentList[$this.Type].forEach((item) =>\r\n                        {\r\n                            if ((item) !== $this && item.isActive)\r\n                                item.Hide();\r\n                        });\r\n                    }\r\n                    if (Dialog){\r\n                        Lure._DialogCount++;\r\n                        $this.Content.classList.add('lure-dialog');\r\n                        //    console.log('DialogWrapper', DialogWrapper);\r\n                        if (DialogWrapper){\r\n                            $this.DialogWrapper = Lure.CreateElementFromString('<div class=\"dialog-wrapper\">');\r\n                            document.body.appendChild($this.DialogWrapper);\r\n                            $this.DialogWrapper.onclick = $this.Hide.bind($this);\r\n\r\n                            let zIndexWrapper = parseInt(window.getComputedStyle($this.DialogWrapper).zIndex);\r\n                            let zIndexContent = parseInt(window.getComputedStyle($this.Content).zIndex);\r\n                            if (Number.isNaN(zIndexContent) || zIndexContent < zIndexWrapper)\r\n                                $this.Content.style.zIndex = zIndexWrapper+1;\r\n                        }\r\n\r\n                        if (DialogBlur)\r\n                        {\r\n                            $this.DialogWrapper.style.background = 'none';\r\n                            Lure.Select(DialogBlur).classList.add('lure-blur');\r\n                        }\r\n                        if (DialogAnimation){\r\n                            $this.Content.classList.add(DialogAnimation);\r\n                        }\r\n                    }\r\n                    BeforeShow.call($this, e);\r\n                    Shower.call($this, e);\r\n                    $this.Content.style.display = '';\r\n                    clearTimeout($this.__private.ToggleTimer);\r\n                    //this.Content.addEventListener('transitionend', Show.bind($this, e));\r\n                    if (Show !== null) {\r\n                        $this.__private.ToggleTimer = setTimeout(function() {\r\n                            Show.call($this, e);\r\n                        },duration);\r\n                    }\r\n                };\r\n                this.Hide = function(e) {\r\n                    this.isActive = false;\r\n                    if (this.Control)\r\n                        this.Control.Disactive();\r\n                    let style = window.getComputedStyle($this.Content);\r\n                    let duration = eval(style.transitionDuration.replace('ms', '*1').replace('s', '*1000'));\r\n                    let durationAni = eval(style.animationDuration.replace('ms', '*1').replace('s', '*1000'));\r\n                    if (duration < durationAni)\r\n                        duration = durationAni;\r\n                    duration++;\r\n                    if (Dialog)\r\n                    {\r\n                        Lure._DialogCount--;\r\n                        if ($this.DialogWrapper)\r\n                            $this.DialogWrapper.remove();\r\n                        if (DialogBlur  && Lure._DialogCount < 1)\r\n                            Lure.Select(DialogBlur).classList.remove('lure-blur');\r\n                    }\r\n\r\n                    Hider.call($this, e);\r\n                    clearTimeout($this.__private.ToggleTimer);\r\n                    if (Hide !== null)\r\n                        $this.__private.ToggleTimer = setTimeout(function () {\r\n                            Hide.call($this, e);\r\n                        }, duration);\r\n\r\n                };\r\n                this.Toggle = function(e){\r\n                    if ($this.isVisible)\r\n                        $this.Hide(e);\r\n                    else\r\n                        $this.Show(e);\r\n                };\r\n\r\n                this.__private = {};\r\n                this.__private.ToggleTimer = null;\r\n                this.Control = new Lure.Plugin.Content.Control(Control, $this);\r\n                this.Content.onclick = OnClick? OnClick.bind($this) : null;\r\n                //SubContent\r\n                if (Array.isArray(SubContent)){\r\n                    for (let i = 0; i < SubContent.length; i++){\r\n                        {\r\n                            if (!SubContent[i].Parent)\r\n                                SubContent[i].Parent = $this;\r\n                            //  $this.__private.ContentNames.push(SubContent[i].Name);\r\n                            $this[SubContent[i].Name] = new Lure.Content( SubContent[i] );\r\n                        }\r\n                    }\r\n                }\r\n                else {\r\n                    for (let cname in SubContent){\r\n                        SubContent[cname].Parent = $this;\r\n                        SubContent[cname].Name = cname;\r\n                        //       $this.__private.ContentNames.push(cname);\r\n                        $this[cname] = new Lure.Content(SubContent[cname]);\r\n                    }\r\n                }\r\n                //title\r\n                this.TitleContent = Lure.Select(Title, this.Content);\r\n\r\n                if ( (Type === \"Untyped\" && Visible !== false) && !Dialog)\r\n                    Visible = true;\r\n                else if ( (Type !== \"Untyped\" && Visible !== true) || ( Dialog && Visible !== true) )\r\n                    Visible = false;\r\n                //if (Typed) Content is Visible\r\n                if (Visible){\r\n                    this.Content.style.display = '';\r\n                    if (this.Control)\r\n                        this.Control.Active();\r\n                }\r\n                else { //not undefined\r\n                    this.isActive = false;\r\n                    this.Content.style.display = 'none';\r\n                }\r\n                if (Controller){\r\n                    if (Controller.isController){\r\n                        this.Controller = Controller;\r\n                        this.Controller.Parent = this;\r\n                    }\r\n                    else{\r\n                        if (!Controller.Target)\r\n                            Controller.Target = this.Content;\r\n                        if (!Controller.Type)\r\n                            Controller.Type = \"Templator\";\r\n                        Controller.Parent = this;\r\n                        this.Controller = new Lure.Plugin.Content.Controller[Controller.Type](Controller);\r\n                    }\r\n                    if (this.Controller.isHasEditable)\r\n                    {\r\n                        Lure._EditablesEventListenerRun($this.Content);\r\n                    }\r\n                }\r\n\r\n                if (Sorting){\r\n                    $this._Sorting = {};\r\n                    $this._Sorting._sorter = null;\r\n                    for (let f in Sorting){\r\n                        if (Sorting.hasOwnProperty(f) && f !== '_sorter'){\r\n                            $this._Sorting[f] = {\r\n                                Target: $this.Select(Sorting[f]),\r\n                                Sorted: false,\r\n                            };\r\n                            $this._Sorting[f].Target.classList.add('mt-sorting');\r\n                            $this._Sorting[f].Target.addEventListener('click', function () {\r\n                                $this._Sorting._sorter = f;\r\n                                $this._SortBy(f, $this.Controller._Data);\r\n                            })\r\n                        }\r\n                    }\r\n                    console.info('mt-sortable', $this._Sorting);\r\n                }\r\n                if (Filtering){\r\n                    $this._Filter = {};\r\n                    $this._Filter._DataDefault = $this.Controller._Data.slice(0);\r\n                    for (let f in Filtering){\r\n                        if (Filtering.hasOwnProperty(f) && f !== '_format'){\r\n                            $this._Filter[f] = {\r\n                                Target: $this.Select(Filtering[f]),\r\n                                Filter: '',\r\n                            };\r\n                            $this._Filter[f].Target.classList.add('mt-filtering');\r\n                            $this._Filter[f].Target.innerHTML = '<input type=\"text\" class=\"mt-filtering-input\">';\r\n                            $this._Filter[f].Target.querySelector('.mt-filtering-input').addEventListener('keyup', function (e) {\r\n                                //$this._SortBy(f);\r\n                                $this._Filter[f].Filter = e.target.value.toLowerCase();\r\n                                $this._FilterBy();\r\n\r\n                            })\r\n                        }\r\n                    }\r\n                }\r\n                if (!Lure.ContentList[$this.Type]) //if list is empty, create it, else just add\r\n                    Lure.ContentList[$this.Type] = [];\r\n                Lure.ContentList[$this.Type].push(this);\r\n\r\n                //close button\r\n                Array.from(this.Content.children).forEach(function(item){\r\n                    if (item.classList.contains(\"close\"))\r\n                        item.onclick = function (e) {\r\n                            $this.Hide(e);\r\n                        }\r\n                });\r\n\r\n                setTimeout(function () {\r\n                    AfterBuild.call($this);\r\n                }, 1);\r\n            }\r\n\r\n        }\r\n        get isVisible(){\r\n            return Lure.isVisible(this.Content);\r\n        }\r\n        get Title(){\r\n            return this.TitleContent.innerHTML;\r\n        }\r\n        set Title(t){\r\n            this.TitleContent.innerHTML = t;\r\n        }\r\n        get Data(){\r\n            if (this.Controller)\r\n                return this.Controller.Data;\r\n            return null;\r\n        }\r\n        set Data(data){\r\n            if (this.Controller)\r\n                this.Controller.Data = data;\r\n        }\r\n        get Items(){\r\n            if (this.Controller)\r\n                return this.Controller.Items;\r\n            return null;\r\n        }\r\n        RefreshOne(i){\r\n            if (this.Controller)\r\n                this.Controller.RefreshOne(i);\r\n        }\r\n        Remove(i, removeData){\r\n            if (this.Controller)\r\n                this.Controller.Remove(i, removeData);\r\n        }\r\n        Add(itemData, extraclass = false, isPrepend = false, addData = true){\r\n            if (this.Controller)\r\n                this.Controller.Add(itemData, extraclass, isPrepend, addData);\r\n        }\r\n\r\n        /**\r\n         *\r\n         * @param {object} itemData\r\n         * @param {int} index\r\n         * @constructor\r\n         */\r\n        Edit(itemData, index){\r\n            if (this.Controller)\r\n                this.Controller.Edit(itemData, index);\r\n        }\r\n        Dispose(){\r\n            this.Content.remove();\r\n            this.Control.Disactive();\r\n            delete this.Controller;\r\n            delete this.Control;\r\n        }\r\n    },\r\n    Control: class LureControl{\r\n        constructor(control, owner){\r\n            if (control === null)\r\n                return;\r\n            if (control.length > 0) //if control list not empty\r\n            {\r\n                let controls = this;\r\n                for (let i = 0; i < control.length; i++)\r\n                {\r\n                    if (!control[i].Name)\r\n                        control[i].Name = \"unnamed_\" + Math.random().toString(36).replace(/[^a-z]+/g, '').substr(0, 10);\r\n                    controls[control[i].Name] = {\r\n                        Content: Lure.SelectAll(control[i].Target),\r\n                        _Content: control[i].Target,\r\n                        Type: control[i].Type ? control[i].Type : \"Untyped\",\r\n                        isGlobal: control[i].Global,\r\n                        OnClick: control[i].OnClick ? control[i].OnClick : owner.Show,\r\n                        OnChange: control[i].OnChange,\r\n                        Active: function(){\r\n                            Lure.SelectAll(control[i].Target).forEach(function (item) {\r\n                                item.classList.add('active');\r\n                            })\r\n                        },\r\n                        Disactive: function(){\r\n                            Lure.SelectAll(control[i].Target).forEach(function (item) {\r\n                                item.classList.remove('active');\r\n                            });\r\n                        }\r\n\r\n                    };\r\n                    //onclick\r\n                    controls[control[i].Name].Content.forEach(function (item) {\r\n                        item.classList.add('pointer');\r\n                    });\r\n                    if (control[i].Global){\r\n\r\n                        Lure.AddEventListenerGlobal('click', control[i].Target, function (e) {\r\n                            Lure.SelectAll(control[i].Target).forEach(function (item) {\r\n                                item.classList.remove('active');\r\n                            });\r\n                            e.target.classList.add('active');\r\n                            if (controls[control[i].Name].OnClick)\r\n                                controls[control[i].Name].OnClick.call(owner, e);\r\n                        });\r\n                    }\r\n                    else{\r\n                        controls[control[i].Name].Content.forEach(function (item) {\r\n                            item.onclick = function (e) {\r\n                                Lure.ContentList[owner.Type].forEach((item) =>\r\n                                {\r\n                                    if ((item) !== owner)\r\n                                    {\r\n                                        if (item.Control)\r\n                                            item.Control.Disactive();\r\n                                    }\r\n                                });\r\n                                //console.log('remover', e);\r\n                                controls[control[i].Name].Content.forEach(function (item) {\r\n                                    item.classList.remove('active');\r\n                                });\r\n                                e.currentTarget.classList.add('active');\r\n                                controls[control[i].Name].OnClick.call(owner, e);\r\n                            };\r\n\r\n                        })\r\n                    }\r\n\r\n                    if (control[i].OnChange)\r\n                    {\r\n                        if (control[i].Global){\r\n                            Lure.AddEventListenerGlobal('change', control[i].Target, function (e) {\r\n                                control[i].OnChange.call(owner, e);\r\n                            } )\r\n                        }\r\n                        else{\r\n                            controls[control[i].Name].Content.forEach(function (item) {\r\n                                item.onchange = function (e) {\r\n                                    control[i].OnChange.call(owner, e);\r\n                                };\r\n                            })\r\n                        }\r\n                    }\r\n                }\r\n            }\r\n        }\r\n        Active(type = \"Untyped\"){\r\n            for (let k in this)\r\n                if (this[k].Type === type)\r\n                    this[k].Content.forEach(function (item) {\r\n                        item.classList.add('active')\r\n                    })\r\n        }\r\n        Disactive(type = \"Untyped\"){\r\n            for (let k in this)\r\n                if (this[k].Type === type)\r\n                {\r\n                    this[k].Content.forEach(function (item) {\r\n                        item.classList.remove('active');\r\n                    });\r\n                    if (this[k].isGlobal)\r\n                        Lure.SelectAll(this[k]._Content).forEach(function(item){\r\n                            item.classList.remove('active');\r\n                        })\r\n                }\r\n\r\n        }\r\n    },\r\n    Controller: {\r\n        Templator: class Templator{\r\n            constructor(\r\n                {\r\n                    Target = null,                              //{HTMLelement}\r\n                    Data = [],                                  // {object}, {array} - if object Templator would be refresh, if array - rebuild\r\n                    ListElement = \".list_element\",              //{string} - css selector or dom string\r\n                    //ListElementOnClick = null,                //{function} -\r\n                    EmptyMessage = \"\",\r\n                    EmptyHide = false,      //{bool} - Templator.Content would be hidden if Data.length = 0\r\n                    //DataType = \"untyped\",  //--BAD EXPERIENCE-- ODO when refresh one of typed Templator, would be refreshed/added/removed all of same type Templators (exclude untyped ofcourse)\r\n\r\n                    PageSize = -1,\r\n                    DataCount = -1,         //if > 0 PageGet is requied!!!\r\n                    PageGet = null,         //{function} - requied if DataCount > 0\r\n\r\n                    ShowAllButton = true,\r\n\r\n                    LineSave = function(line, property, newValue, callback=()=>{}){setTimeout(()=>{callback()}, 500)},            // callback would remove editable-waiting css class;\r\n                    LineAdd = function(dataObject, callback=()=>{}){setTimeout(()=>{ callback()}, 500)},                     // callback would remove editable-waiting css class;\r\n                    EditModeSwitch = null,     //checkbox, which toggle to edit mode\r\n                    DataSaveAll = function(){},//TODO\r\n\r\n                    //Sortable = false, //sort data columns\r\n\r\n                    NoAnimation = false,    //TODO\r\n                    NoBuild = false,\r\n\r\n                    BeforeBuild = function(){},\r\n                    AfterBuild = function(){},\r\n                    AfterAdd = function(){},\r\n                    Parent = null           //Lure.Content, which owns this Controller\r\n\r\n                } = {})\r\n            {\r\n                //### DEFINES\r\n                let $this = this;\r\n                this.isController = true;\r\n                if (Parent !== null)\r\n                    this.Content = Lure.Select(Target, Parent.Content);\r\n                else\r\n                    this.Content = Lure.Select(Target);\r\n                this.Target = this.Content;\r\n                this._Data = Data;\r\n                this.EmptyMessage = EmptyMessage;\r\n                this.ListElement = \"\";\r\n\r\n                this.BeforeBuild = BeforeBuild.bind(this);\r\n                this.AfterBuild = AfterBuild.bind(this);\r\n                this.AfterAdd = AfterAdd.bind(this);\r\n                this.Parent = Parent;\r\n                //paginating\r\n                this.PageSize = PageSize;\r\n                this._PageSize = PageSize;\r\n                this._DataCount = DataCount > 0 ? DataCount : this._Data.length ;\r\n                this._PageCursor = 0;\r\n                this._PageGet = PageGet;\r\n\r\n                //server handling\r\n                this.LineAdd = LineAdd;\r\n                this.LineSave = LineSave;\r\n                this.Type = null; // Refresh or ItemList\r\n\r\n                //settings\r\n                this.isShowAllButton = ShowAllButton;\r\n                this.isNoAnimaton = NoAnimation;\r\n                this.isEmptyHide = EmptyHide;\r\n\r\n                //fields to refresh (for refresh type)\r\n                let Dictionary = [];\r\n                this._Dictionary = Dictionary;\r\n                const Refresher = function () {\r\n                    //TODO refresh only changes\r\n                    if (!$this._Data)\r\n                        $this._Data = {};\r\n                    for (let i = 0; i < Dictionary.length; i++)\r\n                    {\r\n\r\n                        for (let j = 0; j < Dictionary[i].fields.length; j++)\r\n                        {\r\n                            let isAttribute = Dictionary[i].fields[j].Target.indexOf('attributes') > -1;\r\n                            let NewValue = Dictionary[i].fields[j].BuildValue($this._Data);\r\n                            if (isAttribute)\r\n                            {\r\n\r\n                                Dictionary[i].obj.attributes[Dictionary[i].fields[j].Target.split(\".\")[1]].value = NewValue;\r\n                            }\r\n                            else {\r\n                                Dictionary[i].obj[Dictionary[i].fields[j].Target] = Dictionary[i].fields[j].BuildValue($this._Data);\r\n                            }\r\n\r\n                        }\r\n                    }\r\n                };\r\n                this._Rebuilder = function (data = $this._Data) {\r\n                    let lines = \"\";\r\n                    //$this.Content.style.display = '';\r\n                    if ($this._PageCursor === 0 )\r\n                        $this.Content.querySelectorAll('.mt-line, .mt-paginator, .mt-empty').forEach(function(item) {item.remove();});\r\n                    //pagination check\r\n                    let NextCount;\r\n                    //let line;\r\n                    let Limit = data.length;\r\n                    $this._DataCount = DataCount > 0 ? DataCount : Limit ;\r\n                    if ($this.PageSize > 0)\r\n                    {\r\n                        //  debugger;\r\n                        $this._DataCount = $this._DataCount > 0 ? $this._DataCount : data.length ;\r\n                        let paginator = $this.Content.querySelector('.mt-paginator');\r\n                        if (paginator !== null)\r\n                            paginator.remove();\r\n                        Limit = parseInt($this._PageCursor) + parseInt($this.PageSize);\r\n                        if (Limit > $this._DataCount && $this._DataCount > 0)\r\n                            Limit = $this._DataCount;\r\n                        //how much will be load in next step\r\n                        NextCount = $this._DataCount - Limit;\r\n                        if (NextCount > $this.PageSize)\r\n                            NextCount = $this.PageSize;\r\n                    }\r\n                    if ($this.Type === \"ItemList\" && data.length === 0 && $this.EmptyMessage !== \"\" && !$this.isEmptyHide)\r\n                    {\r\n                        let tag = $this.ListElement.match(/\\s?([\\w]+) /)[0].replace(/\\s/g, \"\");\r\n                        let empty = document.createElement(tag);\r\n                        empty.classList.add('mt-empty');\r\n                        empty.innerHTML = $this.EmptyMessage;\r\n                        $this.Content.appendChild(empty);\r\n                        return;\r\n                    }\r\n                    else if ($this.Type === \"ItemList\" && data.length === 0 && $this.isEmptyHide){\r\n                        $this.Content.style.display = 'none';\r\n                        return;\r\n                    }\r\n                    else if (data.length === 0) {\r\n                        return;\r\n                    }\r\n                    //linebuilding\r\n                    for (let i = $this._PageCursor; i < Limit; i++)\r\n                        lines += $this._LineBuilder(data[i], i, data.length);\r\n                    //appending\r\n                    //   debugger;\r\n                    if ($this.Content.children.length < 1)\r\n                    {\r\n                        $this.Content.innerHTML = lines;\r\n                    }\r\n                    else{\r\n                        lines = Lure.CreateElementsFromString(lines, $this.Content.tagName);\r\n                        if (lines !== null)\r\n                            lines.forEach(function (item) {\r\n                                $this.Content.appendChild(item);\r\n                            });\r\n                    }\r\n                    /*{\r\n                     lines += $this._LineBuilder(data[i], i, data.length);\r\n                     //if should to save changed class list after rebuild\r\n                     if (data[i] && data[i].$classlist)\r\n                     {\r\n                     line = $(line);\r\n                     line.attr('class', data[i].$classlist);\r\n                     lines +=line[0].outerHTML;\r\n                     }\r\n                     else{\r\n                     lines += line;\r\n                     }\r\n                     }*/\r\n                    //save cursor index\r\n                    if ($this.PageSize > 0)\r\n                        $this._PageCursor = Limit;\r\n                    //PAGINATION BUILD\r\n                    //limit data case\r\n                    if ($this.PageSize > 0 && $this._PageCursor < $this._DataCount){\r\n                        let also;\r\n                        let showAll = `<span>  (  ${($this._DataCount- $this._PageCursor)}) </span>`;\r\n                        if ($this.isShowAllButton)\r\n                        {\r\n                            showAll = `<span>  </span><span class=\"mt-btn-nextAll dotted pointer\">  ( ${($this._DataCount - $this._PageCursor)} )</span>`;\r\n                        }\r\n                        let isTable = $this.Content.tagName === 'table' || $this.Content.tagName === 'thead' || $this.Content.tagName === 'tbody';\r\n                        if (isTable)\r\n                        {\r\n                            let colspan = $this.Content.querySelector(\"tr:first-child th\").length + 1;\r\n\r\n                            also = `<tr class=\"mt-paginator\"><td colspan=\"${colspan}\" class=\"element block-head\"><span class=\"tpltr-next dotted pointer\">  ${NextCount}</span>${showAll}</td></tr>`;\r\n                            also = Lure.CreateElementFromString(also, $this.Content.tagName);\r\n                        }\r\n                        else {\r\n                            also = Lure.CreateElementFromString(`<div class='mt-paginator'><span class=\"mt-btn-next dotted pointer\">  ${NextCount}</span>${showAll}</div>`);\r\n\r\n                        }\r\n                        let btnNext = also.querySelector('.mt-btn-next');\r\n                        //console.log('btnNext', btnNext);\r\n                        btnNext.onclick = function(){\r\n                            if ($this._PageCursor >= data.length)\r\n                                $this._PageGet($this._PageCursor, $this.PageSize, BuildWithIt);\r\n                            else\r\n                                Build();\r\n\r\n                        };\r\n                        let btnNextAll = also.querySelector('.mt-btn-nextAll');\r\n                        btnNextAll.onclick = function(){\r\n                            $this.PageSize = $this._DataCount;\r\n                            if ($this._PageGet !== null)\r\n                                $this._PageGet($this._PageCursor, ($this._DataCount - $this._PageCursor), BuildWithIt);\r\n                            else\r\n                                Build();\r\n                        };\r\n                        $this.Content.appendChild(also);\r\n\r\n                    }\r\n\r\n                };\r\n                const Build = function () {\r\n                    $this.BeforeBuild();\r\n\r\n                    if ($this.Type === \"Refresh\")\r\n                        Refresher();\r\n                    else if ($this.Type === \"ItemList\"/* && $this._Data.length > 0*/)\r\n                        $this._Rebuilder();\r\n\r\n\r\n                    $this.AfterBuild();\r\n                };\r\n                const BuildWithIt = function (data) {\r\n                    for (let i = 0; i < data.length; i++)\r\n                        $this._Data.push(data[i]);\r\n                    Build();\r\n                };\r\n                // = Rebuild1er;\r\n\r\n                //#### METHODS\r\n                this.FieldAdd = function (element) {\r\n                    let elemAttributes = element.attributes;\r\n                    let fields = [];\r\n                    let WhatFields = -1; // 0-att only, 1-innerHTML only, 2-both\r\n                    //find fields in attributes\r\n                    for (let i = 0; i < elemAttributes.length; i++)\r\n                    {\r\n                        if (elemAttributes[i].value.indexOf(\"{{\") > -1)\r\n                        {\r\n                            if (elemAttributes[i].name !== 'value')\r\n                                fields.push({\r\n                                    Target: 'attributes.'+elemAttributes[i].name,\r\n                                    BuildValue: Lure.Compile(elemAttributes[i].value)\r\n                                });\r\n                            else {\r\n                                fields.push({\r\n                                    Target: elemAttributes[i].name,\r\n                                    BuildValue: Lure.Compile(elemAttributes[i].value)\r\n                                });\r\n                            }\r\n                            WhatFields = 0;\r\n                        }\r\n                    }\r\n                    //innerHTML check\r\n                    if (element.childNodes.length < 2)\r\n                    {\r\n                        if (element.innerHTML.indexOf(\"{{\") > -1)\r\n                        {\r\n                            fields.push({\r\n                                Target: \"innerHTML\",\r\n                                BuildValue: Lure.Compile(element.innerHTML)\r\n                            });\r\n                            WhatFields = WhatFields !==0 ? 1:2; //1 if no att, 2 if att exists\r\n\r\n                        }\r\n\r\n                    }\r\n                    if (WhatFields > -1)\r\n                    {\r\n                        Dictionary.push( {\r\n                            obj: element,\r\n                            fields: fields\r\n                        } );\r\n                    }\r\n                };\r\n                this.Refresh = function(data = null, index = null){\r\n                    $this.PageSize = $this._PageSize;\r\n                    $this._PageCursor = 0;\r\n                    if (data !== null)\r\n                        $this._Data = data;\r\n                    $this.PageCursor = 0;\r\n                    if (index === null)\r\n                        Build();\r\n                    else\r\n                        $this.RefreshOne(index);\r\n                };\r\n                this.RefreshOne = function (i) {\r\n                    let newItem = Lure.CreateElementFromString($this._LineBuilder($this._Data[i], i, $this._Data.length), $this.Content.tagName);\r\n                    let itemOld = $this.Items[i];\r\n                    $this.Items[i].parentNode.replaceChild(newItem, itemOld);\r\n                };\r\n                this.Add = function(item, extraclass = false, isPrepend = false, addData = true){\r\n                    if ($this._Data.length === 0 && $this.Content.querySelector(\".mt-empty\") !== null)\r\n                        $this.Content.querySelector(\".mt-empty\").remove();\r\n                    let fragment = document.createDocumentFragment();\r\n                    let elem = document.createElement($this.Content.tagName);\r\n                    let i;\r\n                    if (!isPrepend)\r\n                    {\r\n                        i = $this._Data.length;\r\n                        if (!addData)\r\n                            i--;\r\n                        elem.innerHTML = $this._LineBuilder(item, i, i+1);\r\n                        while (elem.childNodes[0]) {\r\n                            fragment.appendChild(elem.childNodes[0]);\r\n                        }\r\n                        if (extraclass)\r\n                            fragment.children[0].classList.add(extraclass);\r\n                        if (addData)\r\n                            $this._Data.push(item);\r\n                        $this.Content.appendChild(fragment);\r\n                    }\r\n                    else{\r\n                        i = 0;\r\n                        //change data-line attributes\r\n                        $this.Items.forEach(function (item) {\r\n                            console.log(item);\r\n                            console.log(item.dataset['line']);\r\n                            item.dataset['line'] =  parseInt( item.dataset['line'] ) + 1;\r\n                        });\r\n                        //TODO rendered indexes not changings\r\n\r\n                        elem.innerHTML =  $this._LineBuilder(item, 0, $this._Data.length+1);\r\n                        while (elem.childNodes[0]) {\r\n                            fragment.appendChild(elem.childNodes[0]);\r\n                        }\r\n                        if (extraclass)\r\n                            fragment.children[0].classList.add(extraclass);\r\n                        if (addData)\r\n                            $this._Data.unshift(item);\r\n                        $this.Content.prepend(fragment);\r\n                    }\r\n                    //server saver\r\n                    if ($this.LineAdd !== null)\r\n                    {\r\n                        $this.LineAdd(item, function () { //remove extraclass callback\r\n                            let x = $this.Content.querySelector('.'+extraclass);\r\n                            if (x)\r\n                                x.classList.remove(extraclass);\r\n                        });\r\n                    }\r\n                    $this.AfterAdd(item, i);\r\n                };\r\n                this.Edit = function (itemData, i){\r\n                    console.log('edit itemData', i, itemData);\r\n                    Array.from($this.Items).filter(x => parseInt(x.dataset['line'])===i)[0].classList.add('editable-waiting');\r\n                    $this.LineSave(i, '$this', itemData,\r\n                        function () {\r\n                            $this._Data[i] = itemData;\r\n                            $this.RefreshOne(i);\r\n                        });\r\n\r\n                };\r\n                /**\r\n                 *\r\n                 * @param {int} index\r\n                 * @param {bool} removeData\r\n                 * @constructor\r\n                 */\r\n                this.Remove = function(index, removeData = true){\r\n                    //TODO rendered indexes not changings\r\n                    $this.Content.querySelector(`.mt-line[data-line=\"${index}\"]`).remove();\r\n                    for (let j = index; j < $this.Items.length; j++){\r\n                        $this.Items[j].dataset['line'] =  parseInt( $this.Items[j].dataset['line'] ) - 1;\r\n                        $this.Items[j].querySelectorAll('[data-line]').forEach(function (item) {\r\n                            item.dataset['line'] = parseInt( item.dataset['line'] ) - 1;\r\n                        })\r\n                    }\r\n                    if (removeData)\r\n                        $this._Data.splice(index, 1);\r\n                    if ($this._Data.length === 0)\r\n                        $this.Refresh();\r\n                };\r\n                this.SwitchToEditMode = function () {\r\n                    Lure.Editable.EditMode = true;\r\n                    Lure.SelectAll('.editable', $this.Content).forEach(function (item) {\r\n                        // console.log(item);\r\n                        Lure.Editable.AddEdits(item);\r\n                    });\r\n                };\r\n\r\n                //### CONSTRUCTOR\r\n                if ( Array.isArray(this._Data) ){\r\n                    this.Type = \"ItemList\";\r\n                    const isListElementCssSelector = ListElement.match(/^[a-zA-Z0-9.,\\-_ *#]+$/g) !== null;\r\n                    if (isListElementCssSelector){\r\n                        let element = this.Content.querySelector(ListElement);\r\n                        element.classList.add('mt-line');\r\n                        ListElement = element.outerHTML;\r\n                        element.remove();\r\n                    }\r\n                    else{\r\n                        let list_element = ListElement.match(/<[^>]+>/)[0];\r\n                        let list_elementClassed;\r\n                        let pos = list_element.indexOf('class=\"');\r\n                        if (pos < 0)\r\n                        {\r\n                            list_elementClassed = list_element.substr(0,list_element.length - 1) + ' class=\"mt-line\"' + list_element.substr(list_element.length-1);\r\n                        }\r\n                        else\r\n                        {\r\n                            pos = list_element.indexOf('\"', pos+8);\r\n                            list_elementClassed = list_element.substr(0,pos) + \" mt-line\" + list_element.substr(pos);\r\n                        }\r\n                        ListElement = ListElement.replace(list_element, list_elementClassed);\r\n                    }\r\n                    //add data-line attribute\r\n                    ListElement = ListElement.replace(/<[\\s\\S]+?(>)/, function (a, b) {\r\n                        return a.replace(b, ' data-line=\"{{i}}\">')\r\n                    });\r\n                    this.ListElement = ListElement;\r\n                    this._LineBuilder = Lure.Compile(ListElement, true);\r\n                    if (ListElement.match(/<[^>]+class=['\"][\\w\\d\\s-]*(editable)[\\w\\d\\s-]*['\"][^>]*>([^<]*)<[^>]*>/) !== null)\r\n                    {\r\n                        this.isHasEditable = true;\r\n                        if (EditModeSwitch !== null)\r\n                            Lure.Select(EditModeSwitch).addEventListener('change', function (e) {\r\n                                if ( e.currentTarget.checked ){\r\n                                    $this.SwitchToEditMode();\r\n                                }\r\n                                else{\r\n                                    Lure.Editable.EditMode = false;\r\n                                    document.body.click();\r\n                                }\r\n                            });\r\n                    }\r\n                    this.Content.MonsieurController = this;\r\n                    this.Content.classList.add('mt-content');\r\n\r\n                }\r\n                else {\r\n                    this.Type = \"Refresh\";\r\n                    let AllChildren = Array.prototype.slice.call( this.Content.querySelectorAll('*:not(g):not(path):not(clipPath):not(text):not(br)'));\r\n                    AllChildren.push( this.Content);\r\n                    AllChildren.forEach(function (item) {\r\n                        $this.FieldAdd(item);\r\n                    })\r\n                }\r\n                Lure.TemplatorList.push(this);\r\n                if (!NoBuild)\r\n                    Build();\r\n            }\r\n            get Data(){\r\n                return this._Data;\r\n            }\r\n            set Data(data){\r\n                this._Data = data;\r\n            }\r\n            get Items(){\r\n                return this.Content.querySelectorAll('.mt-line');\r\n            }\r\n        },\r\n        TreeBuilder: class TreeBuilder{\r\n            constructor(\r\n                {\r\n                    Target = null,                          //{string, HTMLElement}\r\n                    Data = [],\r\n                    ListElement = null,\r\n                    Drop = false,                       //{bool}   - horisontal menu with drop down subtrees;\r\n                    SubSelector = null,                 //{string} - cssselector of element, where put branches\r\n                    SubSelectorHandler = function(){},  //{function} - click handle on SubSelector Element (hide/show branch for exaple)\r\n\r\n                    BeforeBuild = function(){},\r\n                    AfterBuild = function(){},\r\n\r\n                    Parent = null               //Lure.Content, which owns this Controller\r\n                }\r\n            )\r\n            {\r\n                //### DEFINES\r\n                this.isController = true;\r\n                this.Content = Lure.Select(Target);\r\n                this.Target = this.Content;\r\n                this.Parent = Parent;\r\n                this._Data = Data;\r\n                this.SubSelector = SubSelector;\r\n                this.SubSelectorHandler = SubSelectorHandler.bind(this);\r\n                this.BeforeBuild = BeforeBuild.bind(this);\r\n                this.AfterBuild = AfterBuild.bind(this);\r\n                let SubTreeClass = Drop ? 'mtb-sub_tree dropable':'mtb-sub_tree';\r\n                let Lvl = 0;\r\n                let Branch = ListElement === null ? this.Content.innerHTML : ListElement;\r\n                if (this.SubSelector === null){\r\n                    this.SubSelector = '.mtb-sub_tree';\r\n                    Branch = Branch.replace(/^([\\s\\S]*)(<\\/\\w+>)$/, function (match, html, entag) {\r\n                        entag = `<div class=\"${SubTreeClass}\"></div>${entag}`;\r\n                        return html+entag\r\n                    })\r\n                }\r\n                this.LineBuilder = Lure.Compile(Branch, true);\r\n                let $this = this;\r\n\r\n                let Index = 0;          //unque serial number of branch\r\n\r\n                let BuildElement = function(obj, key, indexJ) {\r\n                    Index++;\r\n                    let extra = {\r\n                        $lvl: Lvl,\r\n                        $key: key,\r\n                        $index: Index,\r\n                        $j: indexJ\r\n                    };\r\n                    let line = Lure.CreateElementFromString($this.LineBuilder(obj, Index, null, extra));\r\n                    line.classList.add('mtb-branch');\r\n                    for (let key in obj)\r\n                    {\r\n                        let ObjItem = obj[key];\r\n                        if (Array.isArray(ObjItem))\r\n                        {\r\n                            Lvl++;\r\n                            for (let i = 0; i < ObjItem.length; i++)\r\n                            {\r\n                                if ($this.SubSelector === null)\r\n                                {\r\n                                    line.appendChild(  BuildElement(ObjItem[i], key, i) );\r\n                                }\r\n                                else\r\n                                {\r\n                                    line.classList.add('mtb-has_tree');\r\n                                    if (Drop)\r\n                                        line.classList.add('dropable');\r\n                                    let sub = line.querySelector($this.SubSelector);\r\n                                    sub.appendChild(  BuildElement(ObjItem[i], key, i) );\r\n                                }\r\n                            }\r\n                            Lvl--;\r\n                        }\r\n                    }\r\n                    return line;\r\n                };\r\n                let Build = function () {\r\n                    $this.BeforeBuild();\r\n                    if (Array.isArray($this._Data))\r\n                    {\r\n                        $this.Content.innerHTML = '';\r\n                        Lvl++;\r\n                        for (let j = 0; j < $this._Data.length; j++)\r\n                            $this.Content.appendChild(  BuildElement($this._Data[j], \"root\", 0) );\r\n                        Lvl--;\r\n                    }\r\n                    else{\r\n                        $this.Content.appendChild(BuildElement($this._Data, \"root\", 0));\r\n                    }\r\n                    Lvl = 0;\r\n                    Index = 0;\r\n                    $this.AfterBuild();\r\n\r\n                };\r\n\r\n                Build(this._Data);\r\n\r\n                //### METHODS\r\n                this.Refresh = function (data=$this._Data) {\r\n                    $this._Data = data;\r\n                    Build();\r\n                }\r\n\r\n            }\r\n            get Data(){\r\n                return this._Data;\r\n            }\r\n            set Data(data){\r\n                this._Data = data;\r\n            }\r\n        }\r\n    }\r\n};\r\n//register plugin\r\nLure.Content = Lure.Plugin.Content.Content;\r\n\r\n\r\n\r\n\r\n\r\n\r\n//Tutorial\r\n//TargetButton = {string, HTMLElement} - button who start the tutor\r\n//TargetContent = {string, HTMLElement} - select/element where search tutors\r\nLure.Plugin.Tutor = class MonsieurTutor{\r\n    /**\r\n     *\r\n     * @param {HTMLElement} TargetButton\r\n     * @param {HTMLElement} TargetContent\r\n     */\r\n    constructor(TargetButton = null, TargetContent = null){\r\n        //### DEFINES\r\n        let $this = this;\r\n        this.TargetButton = Lure.Select(TargetButton);\r\n        this.TargetContent = Lure.Select(TargetContent);\r\n        const MT = `<div class=\"lure-tutor\">\r\n                        <div class=\"cd-caption\">\r\n                            <span> </span>\r\n                            <span class=\"lure-tutor_step\"></span>\r\n                        </div>\r\n                        <div class=\"lure-tutor_desc\"></div>\r\n                        <div class=\"lure-tutor_btns\">\r\n                            <button class=\"button btn-tutor btn-tutor-stop\"> </button>\r\n                            <button class=\"button btn-tutor btn-tutor-next\">e </button></div>\r\n                   </div>`;\r\n        this.Content = Lure.CreateElementFromString(MT);\r\n        this.ContentBG = Lure.CreateElementFromString('<div class=\"lure-tutor-bg dialog-wrapper\"></div>');\r\n        this.Content.style.display = 'none';\r\n        this.ContentBG.style.display = 'none';\r\n        this._Description = this.Content.querySelector('.lure-tutor_desc');\r\n        this._Step = this.Content.querySelector('.lure-tutor_step');\r\n        this._ButtonNext = this.Content.querySelector('.btn-tutor-next');\r\n        this._ButtonStop = this.Content.querySelector('.btn-tutor-stop');\r\n\r\n        $this.Data = [];\r\n        const ButtonNextText = this._ButtonNext.innerHTML;\r\n        let TutorPosition = 0;\r\n        /*get transparent*/\r\n        let temp = document.createElement('div');\r\n        temp.style.display = 'none';\r\n        document.body.appendChild(temp);\r\n        const ColorTransparent = window.getComputedStyle(temp).backgroundColor;\r\n        temp.remove();\r\n        //---\r\n        const ElemCssRestore = function () {\r\n            let Element = $this.Data[TutorPosition-1].obj;\r\n            if (Element.tagName.toLowerCase() !== 'tr')\r\n            {\r\n                Element.style.zIndex = '';\r\n                Element.style.position = '';\r\n                Element.style.outline = '';\r\n                Element.style.display = '';\r\n                Element.style.backgroundColor = '';\r\n                return;\r\n            }\r\n            let nElements = Element.querySelectorAll('th, td');\r\n            nElements.forEach(function (elem) {\r\n                elem.style.position = '';\r\n                elem.style.zIndex = '';\r\n            });\r\n        };\r\n        const ElemCssSet = function (Element) {\r\n            if (Element.tagName.toLowerCase() !== 'tr')\r\n            {\r\n                Element.style.zIndex = '11';\r\n                Element.style.position = 'relative';\r\n                Element.style.outline = '5px #bee0ff solid';\r\n                let style = window.getComputedStyle(Element);\r\n                if (style.backgroundColor === ColorTransparent)\r\n                    Element.style.backgroundColor = \"#fff\";\r\n                if (!Lure.isVisible(Element) )\r\n                {\r\n                    if (Element.tagName.toLowerCase() !== \"table\" )\r\n                        Element.style.display = 'block';\r\n                    else\r\n                        Element.style.display = 'table';\r\n                }\r\n                /* if (Element.length > 1)\r\n                 Element.eq(1).css({zIndex: '', outline: ''});*/\r\n                return;\r\n            }\r\n            let nElements = Element.querySelectorAll('th, td');\r\n            nElements.forEach(function (elem) {\r\n                elem.style.zIndex = \"11\";\r\n                elem.style.position = \"relative\";\r\n                let style = window.getComputedStyle(elem);\r\n                if (style.backgroundColor === ColorTransparent){\r\n                    elem.style.backgroundColor = \"#fff\";\r\n                }\r\n            });\r\n            /* if (Element.length > 1)\r\n             Element.eq(1).css({zIndex: '', outline: ''});*/\r\n        };\r\n        const Run = function () {\r\n            console.log(\"tutor run\");\r\n            if ($this.TargetContent === null)\r\n                return;\r\n            let Items = $this.TargetContent.querySelectorAll('*[data-tutor]:not([data-line]), *[data-tutor][data-line=\"0\"]');\r\n            if (Items.length < 1){\r\n                Lure.Confirm(\"\", \"    \");\r\n                return;\r\n            }\r\n            // document.body.style.position = 'relative';\r\n\r\n            Items.forEach(function (item) {\r\n                $this.Data.push({\r\n                    obj: item,\r\n                    desc: item.dataset['tutor']\r\n                })\r\n            });\r\n            $this.Content.style.display = '';\r\n            $this.ContentBG.style.display = '';\r\n            GoStep();\r\n        };\r\n        const GoStep = function () {\r\n            //restore prev element's css\r\n            if (TutorPosition > 0)\r\n                ElemCssRestore();\r\n            if (TutorPosition === $this.Data.length)\r\n            {\r\n                Stop();\r\n                return;\r\n            }\r\n            //select next elem\r\n            let Element = $this.Data[TutorPosition].obj;\r\n            let ElementDesc = $this.Data[TutorPosition].desc;\r\n            // check for invisible parent\r\n            let ElemParent = ElementDesc.match(/{([\\s\\S]+)}/);\r\n            if (ElemParent !== null)\r\n            {\r\n                ElemParent = ElemParent[1];\r\n                ElementDesc = ElementDesc.replace(/{([\\s\\S]+)}/, '');\r\n                Element = Element.closest(ElemParent);\r\n                $this.Data[TutorPosition].obj = Element;\r\n                //Element.push( );\r\n            }\r\n            //set element visible\r\n            ElemCssSet(Element);\r\n            //write new element title and desc\r\n            $this._Step.innerHTML = (TutorPosition+1) + \"/\"+$this.Data.length;\r\n            $this._Description.innerHTML = ElementDesc;\r\n            //caption next button\r\n            if ((TutorPosition+1) === $this.Data.length)\r\n            {\r\n                $this._ButtonNext.innerHTML = '';\r\n                $this._ButtonStop.style.opacity = '0';\r\n            }\r\n\r\n            //move tutor desc box\r\n            let posX = Element.offsetLeft + Element.clientWidth + 10;\r\n            let posY = Element.offsetTop - $this.Content.clientHeight - 10;\r\n            if (posY < 10)\r\n                posY = 10;\r\n            if ( (posX + $this.Content.clientWidth) > window.innerWidth )\r\n            {\r\n                posX = Element.offsetLeft - $this.Content.clientWidth - 10;\r\n                if (window.innerWidth < $this.Content.clientWidth + Element.clientWidth)\r\n                {\r\n                    posX = Element.offsetLeft + Element.clientWidth - $this.Content.clientWidth - 20;\r\n                }\r\n\r\n            }\r\n            if (document.documentElement.scrollTop  > posY || document.documentElement.scrollTop + window.innerHeight < Element.offsetTop + Element.offsetHeight)\r\n            {\r\n                //$('html, body').animate({scrollTop: posY - 10}, 300);\r\n                document.documentElement.scrollTop =  (posY - 10)  +'px';\r\n            }\r\n            if (posX < 10)\r\n                posX = 10;\r\n            $this.Content.style.left = posX +'px';\r\n            $this.Content.style.top = posY +'px';\r\n\r\n            TutorPosition++;\r\n        };\r\n        const Stop = function () {\r\n            //     document.body.style.position = '';\r\n            ElemCssRestore();\r\n            $this.Content.style.display = 'none';\r\n            $this.ContentBG.style.display = 'none';\r\n            $this._ButtonNext.innerHTML = ButtonNextText;\r\n            $this._ButtonStop.style.opacity = '';\r\n            TutorPosition = 0;\r\n            $this.Data = [];\r\n        };\r\n        //### CONSTRUCT\r\n\r\n        this.TargetButton.onclick = Run;\r\n        this._ButtonNext.onclick = GoStep;\r\n        this._ButtonStop.onclick = Stop;\r\n\r\n        document.body.appendChild(this.Content);\r\n        document.body.appendChild(this.ContentBG);\r\n\r\n        //### METHODS\r\n        this.Run = Run;\r\n\r\n    }\r\n};\r\n\r\n\r\n\r\n\r\nLure.Plugin.Load = class MonsieurLoading{\r\n    constructor(\r\n        {\r\n            Target = 'body'\r\n        } = {}\r\n    ){\r\n        this.Target = Lure.Select(Target);\r\n        this.Target.style.position = 'relative';\r\n        this.Content = Lure.CreateElementFromString(`<div class=\"ajax-loading\" style=\"display: none\"></div>`);\r\n        let cx = 60; //diameter\r\n        let cy = 60;\r\n        let _DoArc = function(radius, maxAngle){\r\n            let d = \" M \"+ (cx + radius) + \" \" + cy;\r\n            for (let angle = 0; angle < maxAngle; angle++)\r\n            {\r\n                let rad = angle * (Math.PI / 180);  //deg to rad\r\n                let x = cx + Math.cos(rad) * radius;\r\n                let y = cy + Math.sin(rad) * radius;\r\n                d += \" L \"+x + \" \" + y;\r\n            }\r\n            return d;\r\n        };\r\n        let svg = `<svg xmlns=\"http://www.w3.org/2000/svg\">\r\n                     <path d=\"${_DoArc(45, 160)}\" class=\"lure-arc1\" fill=\"none\" stroke=\"#449b22\" stroke-width=\"5\"></path>\r\n                     <path d=\"${_DoArc(40, 130)}\" class=\"lure-arc2\" fill=\"none\" stroke=\"#61c8de\" stroke-width=\"5\"></path>\r\n                     <path d=\"${_DoArc(35, 100)}\" class=\"lure-arc3\" fill=\"none\" stroke=\"#761c19\" stroke-width=\"5\"></path>\r\n                     <path d=\"${_DoArc(30, 70)}\"  class=\"lure-arc4\" fill=\"none\" stroke=\"#333333\" stroke-width=\"5\"></path>\r\n                   </svg>`;\r\n        this.Target.appendChild(this.Content);\r\n        this.Content.innerHTML = svg;\r\n        this.Timeout = null;\r\n    }\r\n    Show(){\r\n        let $this = this;\r\n        this.Content.style.display = '';\r\n        clearTimeout(this.TimeoutHide);\r\n        this.Timeout = setTimeout(function(){\r\n            $this.Content.style.display = 'block';\r\n        }, 70);\r\n    }\r\n    Hide(){\r\n        let $this = this;\r\n        clearTimeout(this.Timeout);\r\n        this.TimeoutHide = setTimeout(function(){\r\n            $this.Content.style.display = 'none';\r\n        }, 250); //hide may be called in same time as the show()\r\n    }\r\n};\r\n\r\nLure.Plugin.Tooltip = class MonsieurTooltip{\r\n    constructor({\r\n                    Target    = document,           //Target-listener (global document by default)\r\n                    Attribute = \"data-tooltip\",     // data-tooltip=\"Help text here\"\r\n                    Delay     = 400,                //delay before tooltip show\r\n                    Time      = 1100,               //showing time\r\n                    Cursor    = \"help\",             //item:hover cursor\r\n                    Custom    = `<div class=\"lure-tooltip\">`,               //custom html of tooltip\r\n                    AfterBuild = function(){}\r\n\r\n                })\r\n    {\r\n        let $this = this;\r\n        this.ToolTip = Lure.CreateElementFromString(Custom);\r\n        let Timer = null;\r\n        let Destr = null;\r\n        this.Target = Lure.Select(Target);\r\n        const Show = function (text){\r\n            this.ToolTip.innerHTML = text;\r\n            $this.Target.appendChild(this.ToolTip);\r\n\r\n        }.bind(this);\r\n        Lure.AddEventListenerGlobal('mouseover', `[${Attribute}]`, function (e) {\r\n            let text = e.currentTarget.dataset[Attribute.replace('data-', '')];\r\n            clearTimeout(Destr);\r\n            Timer = setTimeout(function(){\r\n                Show(text);\r\n            }, Delay);\r\n        }, this.Target);\r\n        Lure.AddEventListenerGlobal('mouseout', `[${Attribute}]`, function (e) {\r\n            clearTimeout(Timer);\r\n            Destr = setTimeout(function () {\r\n                //$this.ToolTip.remove();\r\n            }, Time)\r\n        }, this.Target);\r\n        setTimeout(function () {\r\n            AfterBuild.bind($this);\r\n        }, 0)\r\n    }\r\n\r\n};\r\n\r\n\r\n\r\nLure.Tutor = Lure.Plugin.Tutor;\r\nLure.Load = Lure.Plugin.Load;\r\nLure.Tooltip = Lure.Plugin.Tooltip;\r\n\r\n\r\n\r\n\r\n/*\r\n class yWatcher {\r\n constructor(target, handler, level) {\r\n let $this = this;\r\n let mirror = JSON.parse(JSON.stringify(target));\r\n let watch = {};\r\n function setGetSet(obj, prop, handler, tar) {\r\n let oldval = obj[prop];\r\n let newval = oldval;\r\n this['_'+prop] = obj[prop];\r\n let getter = function () {\r\n return this['_'+prop];\r\n };\r\n let setter = function (val) {\r\n oldval = newval;\r\n\r\n tar[prop] = val;\r\n console.log('xo', target);\r\n if (Array.isArray(val) || typeof val === typeof {}) {\r\n setWatcher(val, [prop]);\r\n }\r\n return newval = handler.call(obj, prop, oldval, val);\r\n };\r\n obj[\"_\"+prop] = obj[prop];\r\n if (delete obj[prop]) { // can't watch constants\r\n Object.defineProperty(obj, prop, {\r\n get: getter,\r\n set: setter,\r\n enumerable: true,\r\n configurable: true\r\n });\r\n\r\n }\r\n\r\n\r\n }\r\n\r\n function GetterSetter(obj, prop, deepprop) {\r\n //watch['_'+deepprop] = obj[prop];\r\n console.log('watch', watch);\r\n console.log('obdp', obj, `prop: ${prop}`, `deepprop: ${deepprop}`);\r\n let x = eval(`watch${deepprop}`);\r\n console.log('x', x);\r\n\r\n x['_'+prop] = obj[prop];\r\n let getter = function () {\r\n if (deepprop !== '')\r\n return target[deepprop][prop];\r\n return target[prop];\r\n };\r\n\r\n let setter = function (val) {\r\n let oldval;\r\n if (deepprop !== '')\r\n oldval = target[deepprop][prop];\r\n oldval = target[prop];\r\n console.log('xo', target);\r\n //if (Array.isArray(val) || typeof val === typeof {}) {\r\n //    setWatcher(val, [prop]);\r\n //}\r\n if (deepprop !== '')\r\n target[deepprop][prop] = val;\r\n target[prop] = val;\r\n return handler.call(obj, prop, oldval, val);\r\n };\r\n Object.defineProperty(x, prop, {\r\n get: getter,\r\n set: setter,\r\n enumerable: true,\r\n configurable: true\r\n });\r\n }\r\n this.GetDeep = function getOfDeep(deep){\r\n let s='';\r\n for (let i = 0; i < deep.length; i++){\r\n if (typeof deep[i] === 'undefined' || !deep[i])\r\n return s;\r\n s += `[\"${deep[i]}\"]`;\r\n }\r\n return s;\r\n };\r\n let lvl = 0;\r\n let deep = [];\r\n function setWatcher(obj,) {\r\n //      debugger;\r\n if (!Array.isArray(obj) && typeof obj === typeof {}) {\r\n for (let k in obj) {\r\n if (obj.hasOwnProperty(k)) {\r\n GetterSetter(obj, k, $this.GetDeep(deep));\r\n // setGetSet(obj, k, handler, eval('target'+$this.GetDeep(deep)));\r\n if (Array.isArray(obj[k]) || typeof obj[k] === typeof {}) {\r\n deep.push(k);\r\n lvl++;\r\n setWatcher(JSON.parse(JSON.stringify(obj[k])));\r\n // continue;\r\n }\r\n //deep.slpice(deep.length-1, 1);\r\n }\r\n }\r\n return\r\n }\r\n console.log('-array: ', obj);\r\n }\r\n setWatcher(mirror);\r\n this.o = mirror;\r\n this.watch = watch;\r\n }\r\n }\r\n //let xo = {name: \"vasan\", val: 12, a: {b:'', c: ''}, arr: [11,22]};\r\n let xo = {a: 'vasya', b: 42, c:{d: 'valued'}};\r\n let wa = new Watcher(xo, console.log);\r\n console.log('---');\r\n console.log('xo', xo);\r\n console.log('wa', wa);\r\n\r\n */\r\n\r\n"]}